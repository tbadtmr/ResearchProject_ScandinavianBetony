# README - RADseq Data Processing Pipeline
## Genetic structure and biogeographical history of Betony (*Betonica officinalis*) in Scania, Southern Sweden


## About
This repository contains a reproducible RADseq data analysis pipeline used to study the genetic structure and evolutionary history of *Betonica officinalis* across Europe, with a focus on populations in southern Sweden.
The pipeline covers all stages from raw FASTQ files to population genomics and phylogenetic inference, including quality control, demultiplexing, parameter optimization, SNP filtering, regional structure analysis and diversity assessments.
It is built primarily around the Stacks, PLINK, VCFtools, ADMIXTURE, and IQ-TREE toolkits, with helper scripts in Bash and visualization in R. 

**Workflow overwiew:**
FASTQ → QC → Demultiplexing → Clone Filtering → Parameter Optimization → Assembly → Filtering → Downstream Analysis

## Setup and Data Structure

### Conda environment and versions
All required software can be installed using the provided Conda environment file: `01-info_files/environment_betonica.yml`.

Create and activate the environment:
```sh
conda env create -f 01-info_files/environment_betonica.yml
conda activate betonica_env
```
The exact package and software versions are listed in the .yml file for full reproducibility.

### Project structure
The project is organized into separate folders for scripts, data, results and metadata to keep everything clean and reproducible.

To set up the folder structure from the repository root run:
```sh
mkdir -p 00-scripts 01-info_files 02-raw_data 03-analysis 04-results 05-logs
```

- **00-scripts/**   executable scripts for each step of the analysis workflow
- **01-info_files/**  contains files such as population maps, configuration files and general metadata
- **02-raw_data/**    original raw FASTQ files
- **03-analysis/**    intermediate files and outputs generated during analyses
- **04-results/**   summary tables, plots and other final outputs
- **05-logs/**      log files generated by all tools and pipeline steps

Raw sequencing data are not included in this repository, but the following folder structure and naming convention were used for the workflow:

- 02-data/ 

    >   └── P2A/

    >   └── P2B/ 
    
    >   └── P2C/ 
    
    >   └── P2D/ 

Each subfolder corresponds to one sampling group. Inside each folder, paired-end FASTQ files follow this naming pattern: 
- TC-2514-*group*_S*number*_L001_R1_001.fastq.gz
- TC-2514-*group*_S*number*_L001_R2_001.fastq.gz

Where R1 = forward reads, R2 = reverse reads, *group* = sampling group (e.g. `P2A`, `P2B`, `P2C`, `P2D`) and S*number* = numeric code corresponding to the group (1-4). 


## Usage
Many steps in this workflow process large FASTQ files or big numbers of samples and can take time to complete. It is therefore recommended to run the scripts in the background when working on a Server and log its output.

To run any script directly use:
```sh
./00-scripts/<script_name>.sh
```
To run it in the background while saving all messages and progress to a log file in the `05-logs/` directory use:
```sh
nohup ./00-scripts/<script_name>.sh > 05-logs/<script_name>.log 2>&1 &
```
For simplicity, the following workflow descriptions will only show the direct command form, but the same background execution approach applies to all steps.


## WORKFLOW
### 1. Quality Control of Raw Reads
Per-batch read quality was assessed with **FastQC** and an overall summary report was generated with **MultiQC**. This step ensures sequencing reads are of sufficient quality before downstream analyses.

Input
- Raw FASTQ files located under `02-raw_data/`

HOW TO RUN
```sh
cd ScandinavianBetony
conda activate betonica_env

./00-scripts/01_qc_rawreads.sh
``` 
Outputs
- Individual FastQC reports: `03-analysis/01-qc_rawreads/`  
- Combined MultiQC summary: `04-results/multiqc_rawreads/multiqc_rawreads.html`  

### 2. Demultiplexing and Initial Quality Filtering
Demultiplexing separates raw reads into samples based on their unique barcode sequences. This step is performed with Stacks 'process_radtags', which identifies barcodes, assigns reads to the correct samples and performs basic quality filtering and adapter trimming. All demultiplexed FASTQs are written into a combined output directory.

Input
- Raw FASTQ files located under `02-raw_data/`
- Barcodes: `01-info_files/barcodes/<group>.txt` (one file per group)

Key parameters
- `-e sbfI` — restriction enzyme
- `--inline_null` — inline barcodes in Read 1
- `-r -c -q` — rescue barcodes, clean reads, discard low quality
- `--adapter_1/--adapter_2` — trim Illumina TruSeq adapters
- `--adapter_mm 2` — allow up to 2 mismatches for adapter detection
- `--force-poly-g-check` — remove NovaSeq poly-G artifacts
- `--threads 10` — multithreaded

HOW TO RUN
```sh
.00-scripts/02_demultiplex.sh

# Create a summary file that lists per-sample read retention metrics
.00-scripts/02-summarize_demultiplex.sh
``` 
Outputs
- Demultiplexed FASTQ files: `03-analysis/02-demultiplexed/`
- Summary table of read retention: `04-results/demultiplexing_summary.tsv`

### 3. PCR Duplicate Removal and Second Quality Control
During RADseq library preparation, PCR amplification can produce identical read pairs originating from the same DNA fragment. These clonal reads can artificially inflate coverage and bias genotype likelihoods. Removing them ensures that coverage more accurately reflects sequencing effort rather than PCR bias, improving SNP calling and downstream analyses.
This step can be skipped if duplicate rates are low or if downstream programs (e.g. ipyrad) internally account for duplicates, but we chose to apply clone filtering for cleaner coverage and reproducibility.

We use Stacks `clone_filter`, which identifies identical read pairs and retains only one representative copy.

Input
- Demultiplexed paired FASTQ files: `03-analysis/02-demultiplexed/`

HOW TO RUN
```bash
./00-scripts/03_clonefilter.sh

# Create a summary file with read retention per sample to check how many reads were removeed as PCR duplicates
./ 00-scripts/03_summarize_clonefilter.sh
```
Outputs
- Clone-filtered FASTQ files: `03-analysis/03-clonefiltered/`
- Summary table: `04-results/clone_filter_summary.tsv`

#### Second Quality control
This step assesses the quality of reads after demultiplexing and PCR duplicate removal. Key quality metrics (GC% and mean Phred score for Read 1) are then extracted from the MultiQC reports for easy comparison across samples.

HOW TO RUN
```sh
# FastQC + MultiQC on clone-filtered reads
./00-scripts/04_qc_clonefilter.sh

# Extract key metrics (GC% and mean Phred, Read 1) from MultiQC outputs
python 00-scripts/04_qc_metrics.py
```
Outputs
- MultiQC summary: `04-results/multiqc_clonefiltered/multiqc_clonefiltered.html`
- GC % per sample: `04-results/gc_content_read1.tsv — GC % per sample`
- Mean Phred quality per sample: `04-results/mean_phred_read1.tsv`
- Merged summary containing both metrics: `04-results/qc_read1_summary.tsv`

### 4. Parameter Optimization
To estimate the optimal Stacks assembly parameters, we use a subset of 15 representative samples (3 randomly selected from each geographic group) to capture the diversity of the full dataset while keeping runtimes manageable for repeated testing. The sample list is provided in `01-info_files/subset_samples.txt`.

To select assembly parameter we then optimize the three main Stacks parameter sequentially (m -> M -> n) using a shell script for each value and **RADstackshelpR** to select the value to carry forward.

What each parameter controls:
- m = minimum number of identical reads required to create a stack
- M = maximum distance (in mismatches) between stacks within an individual
- n = maxmum distance (in mismatches) between stacks across individuals when building the catalog

HOW TO RUN
```sh
# 1. Optimize m
./00-scripts/05_optimize_m.sh

# Install RADstackshelper package
R
> install.packages("RADstackshelpR")
> q()
# Run Rscript to choose optimal m parameter
Rscript 00-scripts/05_parameter_choice.R m 03-analysis/05-parameters/m

# 2. Optimize M: use selected m value (here: 6)
./00-scripts/05_optimize_M.sh <m>
# Choose optimal M
Rscript 00-scripts/05_parameter_choice.R M 03-analysis/05-parameters/M

# 3. Optimize n: use selected m and M values (here: 6 and 4)
./00-scripts/05_optimize_n.sh <m> <M>
# Choose optimal n
Rscript 00-scripts/05_parameter_choice.R n 03-analysis/05-parameters/n
```
Outputs
- Depth, SNPs, loci across tested m values: `04-results/m_panel.png`
- SNPs, loci across tested M values: `04-results/M_panel.png`
- SNPs, loci comparing n = M vs n = M+1: `04-results/n_panel.png`

### 5. Final Assembly and Filtering
After optimizing m, M and n, we perform the final de novo assembly using the selected parameters on the full dataset and run several population filtering thresholds to select the best fitting missing data threshold (r). This step produces the final catalogs and VCF files used for downstream analyses.

The script `06_final_denovo.sh` runs `denovo_map.pl` on all clone-filtered reads using the full popmap and runs four population filtering thresholds (r = 0.5, 0.6, 0.7, 0.8, minmaf = 0.01).

HOW TO RUN
```sh
# Run the final de novo assembly with selected parameters (here: m=6, M=4, n=5)
./00-scripts/06_final_denovo.sh <m> <M> <n>
```
Output
- Each run produces a VCF and other output files in `03-analysis/06-finalrun/<run_name>/`

After completing the assembly and population filtering, the population runs can be summarized to compare locus retention, depth and missing data to help identify the best filtering combination to use for downstream analyses.

HOW TO RUN
```sh
# Print a summary table to the terminal
./00-scripts/06_pop_summary.sh

# Optionally, save results to a TSV file
./00-scripts/06_pop_summary.sh 04-results/pop_summary.tsv
```
Output
- tsv file that computes number of loci, number of variant sites, mean sequencing depth across all called genotypes, mean site-level missingness, individuals with mean depth <20 and >50% missing data

### Filter Samples

Due to low sequencing depth and higher missingness, the sample **11_Trentino** was excluded from further analyses. We therefore re-ran populations using a cleaned popmap (`popmap_noTrentino.txt`) and another run additionally excluding the outgroup (`popmap_noTrentino_noOutgroup.txt`). The script `06_rerun_cleaned_samples.sh` perform both reruns using the selected m, M and n parameters and the filtering threshold r 0.7.

HOW TO RUN
```sh
# Re-run populations excluding 11_Trentino and the outgroup
./00-scripts/06_rerun_cleaned_samples.sh <m> <M> <n>
```
Output
- population outputs for both scenarios: `03-analysis/06-finalrun/r70_noTrentino/` and `03-analysis/06-finalrun/r70_noTrentino_noOutgroup/`

To assess if further filtering is needed, QC summaries (depth, missingness, allele frequencies, heterozygosity) are calculated for the chosen final runs using **VCFtools**.

HOW TO RUN
```sh
# with 11_Trentino removed
./00-scripts/07_vcf_report.sh r70_noTrentino

# without the outgroup
./00-scripts/07_vcf_report.sh r70_noTrentino_noOutgroup
```
Outputs per run
- Results written to `03-analysis/06-finalrun/<run_name>/qc_vcftools/` with standard VCFtools outputs:
    - *_freq2.frq (biallelic frequencies)
    - *_depth_indv.idepth (per-individual depth)
    - *_depth_site.ldepth.mean (per-site mean depth)
    - *_sitequal.lqual (per-site QUAL)
    - *_missing_indv.imiss and *_missing_site.lmiss
    - *_het.het (per-individual heterozygosity)

To create visual summaries and descriptive statsistics from the VCFtools QC outputs, the RScript `06_vcftools_report.R` can be run from the terminal. It reads the results from `03-analysis/06-finalrun/<run_name>/qc_vcftools/` and saves summarized plots and tables to `04-results/qc_vcftools/<run_name>/`.

HOW TO RUN
```sh
# with 11_Trentino removed
Rscript 00-scripts/06_vcftools_report.R r70_noTrentino

# without the outgroup
Rscript 00-scripts/06_vcftools_report.R r70_noTrentino_noOutgroup
```
Outputs per run
- `04-results/qc_vcftools/<run_name>/<run_name>_qc_plots.pdf`
→ multi-page file with depth, missingness, MAF, heterozygosity, and quality distributions
- `04-results/qc_vcftools/<run_name>/<run_name>_qc_summary.tsv`
→ numeric summaries (mean, median, sd, quantiles) for each metric

### Final SNP Filtering

Based on the quality summaries and visual inspections generated, the final SNP datasets are filtered retaining only SNPs with a minor allele frequency ≥ 0.01, depth thresholds were set to 10-150x per site and 5-200x per genotupe and sites with more than 30% missing data were excluded.

Filtered VCFs are saved in `03-analysis/07-finalvcfs/`.

HOW TO RUN
```sh
# make output directory
cd ScandinavianBetony
mkdir -p 03-analysis/07-finalvcfs

# Set run name
RUN="r70_noTrentino"

# Filter dataset
vcftools \
  --vcf 03-analysis/06-finalrun/${RUN}/populations.snps.vcf \
  --remove-indels \
  --max-missing 0.7 \
  --min-alleles 2 --max-alleles 2 \
  --maf 0.01 \
  --min-meanDP 10 --max-meanDP 150 \
  --minDP 5 --maxDP 200 \
  --recode --recode-INFO-all \
  --out 03-analysis/07-finalvcfs/${RUN}_filtered

```
To repeat the filtering for the dataset without 11_Trentino and without the outgroup,
replace the RUN name `r70_noTrentino` with `r70_noTrentino_noOutgroup` in the command above.

### Linkage Disequilibrium pruning

From the filtered dataset, we generated a LD-pruned version to reduce linkeage disequilibrium among SNPs and retain approximately independent markers for downstream analyses, using a 50-SNP window, a step of 5 SNPs and r^2 threshold of 0.2 with PLINK.

HOW TO RUN
```sh
# Create output directory
cd ScandinavianBetony
mkdir -p 03-analysis/07-finalvcfs

# Set run name
RUN="r70_noTrentino"

# Convert to PLINK binary format
plink --vcf 03-analysis/07-finalvcfs/${RUN}_filtered.recode.vcf \
  --double-id --allow-extra-chr --chr-set 95 no-xy \
  --make-bed \
  --out 03-analysis/07-finalvcfs/${RUN}_filtered

# Perform LD pruning (50 SNP window, step 5, r^2 <= 0.2)
plink --bfile 03-analysis/07-finalvcfs/${RUN}_filtered \
  --allow-extra-chr --chr-set 95 no-xy \
  --indep-pairwise 50 5 0.2 \
  --out 03-analysis/07-finalvcfs/${RUN}_LDpruned

# Extract the pruned SNPs back to VCF
plink --bfile 03-analysis/07-finalvcfs/${RUN}_filtered \
  --extract 03-analysis/07-finalvcfs/${RUN}_LDpruned.prune.in \
  --allow-extra-chr --chr-set 95 no-xy \
  --recode vcf \
  --out 03-analysis/07-finalvcfs/${RUN}_pruned

```
The same commands can be run for the dataset without the outgroup by replacing the RUN name `r70_noTrentino` with `r70_noTrentino_noOutgroup`.

Outputs
- no Trentino (filtered): `03-analysis/07-finalvcfs/r70_noTrentino_filtered.recode.vcf`
- no Trentino (LD-pruned): `03-analysis/07-finalvcfs/r70_noTrentino_pruned.vcf`
- no Trentino + no Outgroup (filtered): `03-analysis/07-finalvcfs/r70_noTrentino_noOutgroup_filtered.recode.vcf`
- no Trentino + no Outgroup (LD-pruned): `03-analysis/07-finalvcfs/r70_noTrentino_noOutgroup_pruned.vcf`

### 6. Genetic Structure
### PCA
First an exploratory visualization of the genetic structure is perfromed using Principal Component Analysis implemented in PLINK based on the LD-pruned dataset, excluding the outgroup.

HOW TO RUN
```sh
# Create output folder
cd ScandinavianBetony
mkdir -p 03-analysis/08-downstream/01-pca

# Convert VCF to PLINK binary format
plink \
  --vcf 03-analysis/07-finalvcfs/r70_noTrentino_noOutgroup_pruned.vcf \
  --double-id --allow-extra-chr --chr-set 95 no-xy \
  --make-bed \
  --out 03-analysis/08-downstream/01-pca/r70_noTrentino_noOutgroup_pruned

# Run PCA with the first 10 components
plink \
  --bfile 03-analysis/08-downstream/01-pca/r70_noTrentino_noOutgroup_pruned \
  --pca 10 header tabs \
  --allow-extra-chr --chr-set 95 no-xy \
  --out 03-analysis/08-downstream/01-pca/r70_noTrentino_noOutgroup_pca
```
Outputs
- `03-analysis/08-downstream/01-pca/r70_noTrentino_noOutgroup_pca.eigenvec` - sample coordinates for the first 10 principal components
- `03-analysis/08-downstream/01-pca/r70_noTrentino_noOutgroup_pca.eigenval` - eigenvalues representing the variance explained by each PC

To visualize the PCA results, the RScript `08_plot_pca.R` reads the PLINK output and sample metadata and saves a SVG plot in `04-results`.
HOW TO RUN
```sh
Rscript 00-scripts/08_plot_pca.R r70_noTrentino_noOutgroup
```

### Admixture Analysis
To estimate ancestry proportions, we use ADMIXTURE, which performs maximum-likelihood estimation of individual ancestries based on SNP data for a certain number of ancestral clusters (K). Each K value (1-10) is replicated 50 times with different random seeds to ensure convergence and stability of results. Cross-validation error and summary statistics (mean, sd, min, max) are recorded to identify the most likely number of clusters.

HOW TO RUN
```sh
./00-scripts/09_run_admixture.sh
```
Outputs
-`03-analysis/08-downstream/02-admixture/r70_noTrentino_noOutgroup/`
    - `*.Q / *.P` files per replicate
    - `cv_summary.tsv` (mean, sd, min, max per K)

To visualize the ADMIXTURE results, the RScript `09_plot_admixture.R` reads the ADMIXTURE output files, plots the cross-validation (CV) error across all tested K values, selects the best replicate (lowest CV error) for each K (here K = 2–4), and creates a faceted admixture barplot ordered by population group and sample name.
Both figures are saved as SVG files in `04-results/`.

HOW TO RUN
```sh
Rscript 00-scripts/09_plot_admixture.R r70_noTrentino_noOutgroup
```
Outputs
- CV error plot (mean ± SD across replicates): `04-results/r70_noTrentino_noOutgroup_admixture_cv.svg`
- Faceted admixture barplot (ancestry proportions per individual): `04-results/r70_noTrentino_noOutgroup_admixture_K2-4.svg`
- Table listing the best replicate (lowest CV error) per K: `04-results/r70_noTrentino_noOutgroup_admixture_best_reps.tsv`

### 7. Phylogeny
#### Maximum likelihood tree
The filtered vcf file including the outgroup is converted to PHYLP format and used to infer a maximum-likelihood phylogeny in IQ-TREE. Because RADseq data contain only varaible sites, ascertainment bias correction (+ASC) is applied during model selection. Branch support is estimated with 1,000 ultrafast bootsrap and 1,000 SH-aLRT replicates. The resulting tree is visualized with the RScript `11_plot_tree.R` and saved as an SVG in `04-results/`.

HOW TO RUN
```sh
# Run IQ-TREE (default 8 threads)
./00-scripts/10_run_iqtree.sh r70_noTrentino_noOutgroup

# Plot using consensus if available; otherwise uses the ML treefile
Rscript 00-scripts/11_plot_tree.R r70_noTrentino_noOutgroup

# (optional) re-root on a specific tip label found in the tree
Rscript 00-scripts/11_plot_tree.R r70_noTrentino_noOutgroup "49_Trento_B_hirsuta.1"
```
Outputs
- Maximum-likelihood tree: `03-analysis/08-downstream/03-phylogeny/r70_noTrentino_noOutgroup/r70_noTrentino_noOutgroup.treefile`
- Consensus tree of bootstraps: `03-analysis/08-downstream/03-phylogeny/r70_noTrentino_noOutgroup/r70_noTrentino_noOutgroup.contree`
- Model selection and run summary: `03-analysis/08-downstream/03-phylogeny/r70_noTrentino_noOutgroup/r70_noTrentino_noOutgroup.log`
- Tree plot: `04-results/r70_noTrentino_noOutgroup_tree.svg`

#### NeighborNet Analysis
Download SplitsTree v6 for your operating system from the official website (https://uni-tuebingen.de/en/fakultaeten/mathematisch-naturwissenschaftliche-fakultaet/fachbereiche/informatik/lehrstuehle/algorithms-in-bioinformatics/software/splitstree/). To explore potential phylogenetic conflict and reticulation among individuals, a NeighborNet network is generated in SplitsTree using uncorrected p-distances on the LD-pruned dataset (excluding the outgroup).
We convert the LD-pruned VCF to PHYLIP format using `vcf2phylip.py`. SplitsTree then computes uncorrected p-distances directly from this alignment to construct the unrooted network.

HOW TO RUN
```sh
# Prepare PHYLIP input for SplitsTree
./00-scripts/11_splitstree_input.sh r70_noTrentino_noOutgroup
```
Outputs
- PHYLIP alignment for SplitsTree: `03-analysis/08-downstream/03-phylogeny/r70_noTrentino_noOutgroup_splitstree.phy`

**Run in SplitsTree**
1. Open the `.phy` file above in SplitsTree v6.
2. Go to Compute -> NeighborNet, and select Uncorrected P as the distance measure.
3. Optionally, color or label tips by group to visualize relationships.
4. Export the final network as SVG.

### 8. Genetic Diversity and Differentiation
Genetic diversity is summarized within and between groups using VCFtools by calculating per-individual heterozygosity (Ho/He/F), per-group summaries and pairwise FST across two grouping schemes (all groups and a Scania split). Full outputs are written to the downstream analysis folder, and the key summary tables are exported to `04-results/` for easy access. Pairwise Fst values are visualized as upper-triangle heatmaps for each grouping case.

HOW TO RUN
```sh
# Stats (Ho/He/F per individual & group; pairwise FST)
./00-scripts/12_diversity_stats.sh r70_noTrentino_noOutgroup

# Plot individual heterozygosity and test for differences among groups
Rscript 00-scripts/12_individual_het.R

# Bootstrap 95% CIs for pairwise FST (B=1000 by default)
B=1000 ./00-scripts/12_fst_bootstrap.sh

# Plot FST heatmap for the “all groups” scenario
Rscript 00-scripts/12_plot_fstmap.R allGroups
# Plot FST heatmap for the “Scania split” scenario
Rscript 00-scripts/12_plot_fstmap.R scaniaSplit

```
Outputs
- Full outputs: `03-analysis/08-downstream/04-diversity/`
- Key summaries (copies): `04-results/`
    - diversity_individual_allGroups.tsv, diversity_individual_scaniaSplit.tsv
    - diversity_group_summary_allGroups.tsv, diversity_group_summary_scaniaSplit.tsv
    - diversity_group_SE_allGroups.tsv, diversity_group_SE_scaniaSplit.tsv
    - fst_pairwise_summary_allGroups.tsv, fst_pairwise_summary_scaniaSplit.tsv
    - fst_pairwise_with_CI_allGroups.tsv, fst_pairwise_with_CI_scaniaSplit.tsv
    - fst_pairwise_with_CI.tsv (merged, deduplicated)
- Boxplot of Ho per group: `04-results/heterozygosity_groups.svg`
- Heatmaps: `04-results/fst_heatmap_allGroups.svg` and `04-results/fst_heatmap_scaniaSplit.svg`

### 9. Isolation by Distance and AMOVA
Pairwise genetic dissimilarities (1 – IBS) among individuals are calculated in PLINK and compared with great-circle geographic distances to test for isolation by distance (IBD). Mantel tests (9,999 permutations) assess correlations between genetic and geographic distances both globally and within groups and diagnostic plots visualize the relationships.
We perform an Analysis of Molecular Variance (AMOVA) using the same 1 – IBS matrix to quantify the proportion of genetic variation explained among versus within major geographic regions and with the split of Swedish samples (Scania vs Outliers).

HOW TO RUN
```sh
# Compute pairwise 1–IBS genetic distances
mkdir -p 03-analysis/08-downstream/05-ibd

plink \
  --vcf 03-analysis/07-finalvcfs/r70_noTrentino_noOutgroup_pruned.vcf \
  --double-id --allow-extra-chr --chr-set 95 no-xy \
  --distance 1-ibs square \
  --out 03-analysis/08-downstream/05-ibd/ibs_r70_noTrentino_noOutgroup

# Run Mantel tests and plot results
Rscript 00-scripts/13_ibd_analysis.R r70_noTrentino_noOutgroup
```
Outputs
All written to `04-results/`
- Mantel results
    - Global & Western-excluded correlations: `ibd_mantel_summary.tsv`
    - Within-group Mantel results: `ibd_within_group_mantel.tsv`
- Plots
    - All individuals: `ibd_all_pairs.svg`
    - Excluding Western Europe: `ibd_excluding_western.svg`
    - Within-group regresions: `ibd_within_groups_facets.svg`
- AMOVA
    - Broad regions: `amova_group_summary.tsv`
    - Sweden split: `amova_sweden_group2_summary.tsv`

____
Thank you for taking the time and reading this report :)
____

## Software References
Stacks v2.68 — Catchen, J., Hohenlohe, P. A., Bassham, S., Amores, A., & Cresko, W. A. (2013). Stacks: An analysis tool set for population genomics. Molecular Ecology, 22(11), 3124–3140. DOI: 10.1111/mec.12354

Rochette, N. C., Rivera-Colón, A. G., & Catchen, J. M. (2019). Stacks 2: Analytical methods for paired-end sequencing improve RADseq-based population genomics. Molecular Ecology, 28(21), 4737–4754. DOI: 10.1111/mec.15253

FastQC v0.12.1 — Andrews, S. (2010). FastQC: A Quality Control Tool for High Throughput Sequence Data. Babraham Bioinformatics, Cambridge, UK.

MultiQC v1.28 — Ewels, P., Magnusson, M., Lundin, S., & Käller, M. (2016). MultiQC: Summarize analysis results for multiple tools and samples in a single report. Bioinformatics, 32(19), 3047–3048. DOI: 10.1093/bioinformatics/btw354

VCFtools v0.1.16 — Danecek, P., Auton, A., Abecasis, G., et al. (2011). The variant call format and VCFtools. Bioinformatics, 27(15), 2156–2158. DOI: 10.1093/bioinformatics/btr330

PLINK v1.9 — Purcell, S., Neale, B., Todd-Brown, K., et al. (2007). PLINK: A tool set for whole-genome association and population-based linkage analyses. American Journal of Human Genetics, 81(3), 559–575. DOI: 10.1086/519795

Chang, C. C., Chow, C. C., Tellier, L. C., et al. (2015). Second-generation PLINK: Rising to the challenge of larger and richer datasets. GigaScience, 4, 7. DOI: 10.1186/s13742-015-0047-8

ADMIXTURE v1.3.0 — Alexander, D. H., Novembre, J., & Lange, K. (2009). Fast model-based estimation of ancestry in unrelated individuals. Genome Research, 19(9), 1655–1664. DOI: 10.1101/gr.094052.109

IQ-TREE v2.4.0 — Minh, B. Q., Schmidt, H. A., Chernomor, O., et al. (2020). IQ-TREE 2: New models and efficient methods for phylogenetic inference in the genomic era. Molecular Biology and Evolution, 37(5), 1530–1534. DOI: 10.1093/molbev/msaa015

vcf2phylip v2.0 — Ortiz, E. M. (2019). vcf2phylip v2.0: Convert a VCF matrix into several matrix formats for phylogenetic analysis. Zenodo. DOI: 10.5281/zenodo.2540861

RADstackshelpR — DeRaad, D. (2021). RADstackshelpR: Optimize the De Novo Stacks Pipeline via R. R package.
